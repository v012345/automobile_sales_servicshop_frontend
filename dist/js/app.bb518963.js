(function(t){function e(e){for(var i,s,r=e[0],c=e[1],l=e[2],d=0,p=[];d<r.length;d++)s=r[d],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&p.push(n[s][0]),n[s]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);u&&u(e);while(p.length)p.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],i=!0,r=1;r<a.length;r++){var c=a[r];0!==n[c]&&(i=!1)}i&&(o.splice(e--,1),t=s(s.s=a[0]))}return t}var i={},n={app:0},o=[];function s(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=i,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(a,i,function(e){return t[e]}.bind(null,i));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"041c":function(t,e,a){t.exports=a.p+"img/myCoupons.f23df61e.jpg"},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var i=a("2b0e"),n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("van-form",[i("van-field",{attrs:{label:"门店名称",readonly:"",placeholder:"门店名称"},model:{value:t.activity.shop,callback:function(e){t.$set(t.activity,"shop",e)},expression:"activity.shop"}}),i("van-field",{attrs:{label:"门店电话",readonly:"",placeholder:"门店电话"},model:{value:t.activity.tel,callback:function(e){t.$set(t.activity,"tel",e)},expression:"activity.tel"}}),i("van-field",{attrs:{readonly:"",label:"门店地址",placeholder:"门店地址"},model:{value:t.activity.address,callback:function(e){t.$set(t.activity,"address",e)},expression:"activity.address"}})],1),t._m(0),i("van-form",[i("van-field",{attrs:{required:"",label:"车牌号",placeholder:"车牌号"},model:{value:t.client.licensePlateNumber,callback:function(e){t.$set(t.client,"licensePlateNumber",e)},expression:"client.licensePlateNumber"}}),i("van-field",{attrs:{required:"",label:"手机号",placeholder:"手机号"},model:{value:t.client.phoneNumber,callback:function(e){t.$set(t.client,"phoneNumber",e)},expression:"client.phoneNumber"}}),i("van-field",{attrs:{required:"",label:"姓名",placeholder:"姓名"},model:{value:t.client.name,callback:function(e){t.$set(t.client,"name",e)},expression:"client.name"}}),i("van-field",{attrs:{required:"",label:"车型",placeholder:"车型"},model:{value:t.client.carModel,callback:function(e){t.$set(t.client,"carModel",e)},expression:"client.carModel"}})],1),i("div",{staticClass:"count-down"},[i("img",{attrs:{src:a("6d04")}}),i("div",{staticClass:"text"},["inProgress"==t.activity.state?[i("div",[t._v("报名参加活动")]),i("div",[t._v("活动倒计时")]),i("div",[i("van-count-down",{attrs:{time:t.countDown,format:"DD 天 HH时 mm分 ss秒"},on:{finish:t.activityEnds}})],1)]:[i("div",[t._v("活动已结束")]),i("div",[t._v("下一场活动马上开启")])]],2)]),t.activity.id?[i("div",{staticClass:"van-hairline--bottom"},[t._v(" 已有"+t._s(t.activity.participants.length)+"人关注 ")]),i("div",{staticClass:"participant-avatar"},t._l(Math.min(33,t.activity.participants.length),(function(e){return i("div",{key:e.id,staticClass:"avatar"},[i("van-image",{attrs:{width:"90%",round:"",fit:"cover",src:t.activity.participants[e-1].participant_info.avatar}})],1)})),0),i("div",{staticClass:"van-hairline--bottom"},[t._v(" 已参与"+t._s(t.activity.participantCount)+"人 ")])]:t._e(),i("div",{staticClass:"coupon-buttons"},[i("div",{on:{click:function(e){t.showCoupons=!0}}},[i("img",{attrs:{src:a("041c")}})]),i("div",{on:{click:t.scan}},[i("img",{attrs:{src:a("af1a")}})])]),i("div",{staticClass:"footer"},[t._v("由****提供技术支持")]),i("div",{staticClass:"share-button",on:{click:t.generatePoster}},[i("van-icon",{attrs:{size:"40",color:"#b8b8b8",name:"share-o"}})],1),i("div",{staticClass:"bottom-buttons"},[i("div",{staticClass:"introduction-button",on:{click:function(e){t.showIntroduction=!0}}},[i("p",[t._v("活动锦囊")])]),"end"==t.activity.state?[t._m(1)]:[t.haveACoupon?t._e():[i("div",{staticClass:"sign-up-button",on:{click:t.buyCoupon}},[i("p",[t._v("马上参与("+t._s(t.activity.signing_up_fee)+"元)")])])],t.haveACoupon?[i("div",{staticClass:"sign-up-button"},[i("p",[t._v("已参与("+t._s(t.activity.signing_up_fee)+"元)")])])]:t._e()]],2),i("div",[i("van-popup",{style:{minHeight:"100vw",paddingTop:"1rem"},attrs:{position:"top"},model:{value:t.showIntroduction,callback:function(e){t.showIntroduction=e},expression:"showIntroduction"}},[i("van-tabs",{attrs:{type:"card"}},t._l(2,(function(e){return i("van-tab",{key:e,attrs:{title:1==e?"活动说明":"我的奖品"}},[1==e?i("div",[i("div",[i("van-button",{attrs:{round:"",type:"default"}},[t._v("参与记录")]),i("div")],1),i("div",[i("van-button",{attrs:{round:"",type:"default"}},[t._v("活动时间")]),i("div",[t._v(t._s(t.activity.start_at)+"} - "+t._s(t.activity.end_at)+"}")])],1),i("div",[i("van-button",{attrs:{round:"",type:"default"}},[t._v("技术支持")]),i("div",[t._v('页面技术由"***"提供')])],1)]):t._e()])})),1)],1)],1),i("div",[i("van-popup",{attrs:{closeable:""},model:{value:t.poster.show,callback:function(e){t.$set(t.poster,"show",e)},expression:"poster.show"}},[i("div",{staticClass:"poster"},[i("van-image",{attrs:{width:"100%",src:t.poster.src}})],1)])],1),t.user.id&&t.activity.id?i("div",[i("van-popup",{style:{height:"100vh",paddingTop:"3rem",boxSizing:"border-box"},attrs:{closeable:"",position:"bottom"},model:{value:t.showCoupons,callback:function(e){t.showCoupons=e},expression:"showCoupons"}},[i("van-tabs",{attrs:{type:"card"}},[i("van-tab",{attrs:{title:"可用的",name:"available"}},t._l(t.availableCoupons,(function(e){return i("div",{key:e.id,on:{click:function(a){return t.dealWithTheCoupon(e)}}},[i("Coupon",{attrs:{value:e.value,allow_to_use_at:t.activity.allow_to_use_at,expire_at:t.activity.expire_at}})],1)})),0),i("van-tab",{attrs:{title:"分享的",name:"shared"}},t._l(t.sharedCoupons,(function(e){return i("div",{key:e.id,on:{click:function(a){return t.dealWithTheCoupon(e)}}},[i("Coupon",{attrs:{value:e.value,allow_to_use_at:t.activity.allow_to_use_at,expire_at:t.activity.expire_at}})],1)})),0),i("van-tab",{attrs:{title:"失效的",name:"expired"}},t._l(t.expiredCoupons,(function(e){return i("div",{key:e.id,on:{click:function(a){return t.dealWithTheCoupon(e)}}},[i("Coupon",{attrs:{value:e.value,allow_to_use_at:t.activity.allow_to_use_at,expire_at:t.activity.expire_at}})],1)})),0)],1)],1)],1):t._e()],2)},o=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h3",[t._v("信息登记处")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"sign-up-button"},[a("p",[t._v("活动已结束")])])}],s=a("5530"),r=(a("4de4"),a("d3b7"),a("ac1f"),a("466d"),a("d399")),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"van-coupon__content"},[a("div",{staticClass:"van-coupon__head"},[a("h2",{staticClass:"van-coupon__amount"},[t._v(t._s(t.value)),a("span",[t._v("元")])]),a("p",{staticClass:"van-coupon__condition"},[t._v("无使用门槛")])]),a("div",{staticClass:"van-coupon__body"},[a("p",{staticClass:"van-coupon__name"},[t._v("优惠券")]),a("p",{staticClass:"van-coupon__valid"},[t._v(t._s(t.allow_to_use_at)+"-"+t._s(t.expire_at))]),t._m(0)])])},l=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"van-checkbox van-coupon__corner",attrs:{role:"checkbox",tabindex:"0","aria-checked":"true",size:"18"}},[a("div",{staticClass:"\n          van-checkbox__icon\n          van-checkbox__icon--round\n          van-checkbox__icon--checked\n        "})])}],u={name:"Coupon",props:["value","allow_to_use_at","expire_at"]},d=u,p=a("2877"),v=Object(p["a"])(d,c,l,!1,null,null,null),h=v.exports,f={name:"App",data:function(){return{inviter:void 0,showIntroduction:!1,user:{},activity:{},poster:{show:!1,src:""},client:{licensePlateNumber:"",phoneNumber:"",name:"",carModel:""},showCoupons:!1}},components:{Coupon:h},watch:{activity:function(){}},computed:{haveACoupon:function(){var t=this;if(this.user.id&&this.activity.id){var e=this.user.coupons.filter((function(e){return e.activity_id==t.activity.id&&"normal"==e.type}));if(e.length>0)return!0}return!1},countDown:function(){return this.activity.end_at?this.$dayjs().isBefore(this.activity.end_at)?Math.abs(this.$dayjs().diff(this.activity.end_at,"millisecond")):0:864e5},availableCoupons:function(){var t=this;return this.user.id&&this.activity.id?this.user.coupons.filter((function(e){return e.activity_id==t.activity.id&&t.$dayjs().isBefore(t.activity.expire_at)&&"normal"==e.type})):[]},sharedCoupons:function(){var t=this;return this.user.id&&this.activity.id?this.user.coupons.filter((function(e){return e.activity_id==t.activity.id&&t.$dayjs().isBefore(t.activity.expire_at)&&"shared"==e.type})):[]},expiredCoupons:function(){var t=this;return this.user.id&&this.activity.id?this.user.coupons.filter((function(e){return e.activity_id==t.activity.id&&!t.$dayjs().isBefore(t.activity.expire_at)})):[]}},methods:{test1:function(){var t=this;this.axios.post(this.$api+"posters/test").then((function(e){t.poster.src=e.data,t.poster.show=!0}))},buyCoupon:function(){var t=this;this.user.id&&this.activity.id&&this.axios.post(this.$api+"pay",{amount:.01,payer:this.user.id,open_id:this.user.open_id,activityId:this.activity.id}).then((function(e){t.$wx.chooseWXPay(Object(s["a"])(Object(s["a"])({},e.data),{},{timestamp:e.data.timeStamp,success:function(){setTimeout((function(){t.axios.post(t.$api+"login",{temporaryId:localStorage.temporaryId}).then((function(e){200==e.status&&(t.user=e.data)}))}),3e3)}}))}))},activityEnds:function(){this.activity.state="ended"},scan:function(){this.$wx.scanQRCode({needResult:1,scanType:["qrCode","barCode"],success:function(t){Object(r["a"])({message:t.resultStr})}})},dealWithTheCoupon:function(){},generatePoster:function(){var t=this;this.axios.post("http://localhost/api/posters",{userId:123}).then((function(e){t.poster.src=e.data,t.poster.show=!0}))}},mounted:function(){var t=this;localStorage.activityId=window.location.href.match(/(?<=\/activity\/)(\d+)/g)||localStorage.activityId,this.axios.get(this.$api+"activity/"+localStorage.activityId).then((function(e){t.$dayjs().isBefore(e.data.end_at)?e.data.state="inProgress":e.data.state="ended",t.activity=e.data,localStorage.activityId=e.data.id})),localStorage.inviter=window.location.href.match(/(?<=\/inviter\/)(\d+)/g)||localStorage.inviter,this.inviter=localStorage.inviter,localStorage.temporaryId||(localStorage.temporaryId=this.$uuid.v1()),this.axios.post(this.$api+"login",{temporaryId:localStorage.temporaryId}).then((function(e){204==e.status?t.axios.get(t.$api+"wechat/redirect_uri/"+localStorage.temporaryId).then((function(t){window.location.href=t.data})):200==e.status&&(t.user=e.data,localStorage.activityId&&"undefined"!=localStorage.activityId&&t.axios.post(t.$api+"user/activity",{userId:t.user.id,activityId:localStorage.activityId}))})),this.$wx.ready((function(){t.$wx.updateAppMessageShareData({title:"title321",desc:"desc123",link:"http://amap.100pq.cn/activity/1/inviter/12",imgUrl:"https://www.google.com/url?sa=i&url=https%3A%2F%2Fcommons.wikimedia.org%2Fwiki%2FFile%3AUser_icon_2.svg&psig=AOvVaw2H1JS2UmBkgL1TBmSZ3la6&ust=1643260367689000&source=images&cd=vfe&ved=0CAsQjRxqFwoTCKi4-4XUzvUCFQAAAAAdAAAAABAD",success:function(){Object(r["a"])({message:"updateAppMessageShareData"})}}),t.$wx.updateTimelineShareData({title:"title321",link:"http://amap.100pq.cn/activity/1/inviter/12",imgUrl:"https://www.google.com/url?sa=i&url=https%3A%2F%2Fcommons.wikimedia.org%2Fwiki%2FFile%3AUser_icon_2.svg&psig=AOvVaw2H1JS2UmBkgL1TBmSZ3la6&ust=1643260367689000&source=images&cd=vfe&ved=0CAsQjRxqFwoTCKi4-4XUzvUCFQAAAAAdAAAAABAD",success:function(){Object(r["a"])({message:"updateTimelineShareData"})}})})),this.axios.get(this.$api+"wechat/jssdk",{params:{url:window.location.href}}).then((function(e){t.$wx.config(Object(s["a"])({},e.data))}))}},_=f,y=(a("fc23"),Object(p["a"])(_,n,o,!1,null,"54092240",null)),m=y.exports,b=a("bc3a"),g=a.n(b),w=a("130e"),x=a("b970"),C=a("8c4f"),k=(a("157a"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h2",[t._v("我是About的内容")])}),$=[],A={name:"About"},j=A,S=Object(p["a"])(j,k,$,!1,null,null,null),I=S.exports,O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h2",[t._v("我是Home的内容")])},T=[],P={name:"Home"},F=P,M=Object(p["a"])(F,O,T,!1,null,null,null),B=M.exports,q=new C["a"]({mode:"history",routes:[{path:"/about",component:I},{path:"/home",component:B}]}),D=a("5a0c"),U=a.n(D),E=a("4208"),N=a.n(E),H=a("18a0"),z=a.n(H),Q=a("9612");U.a.extend(N.a),i["a"].use(Q["a"]),i["a"].use(x["a"]),i["a"].use(C["a"]),i["a"].config.productionTip=!1,i["a"].use(w["a"],g.a),new i["a"]({beforeCreate:function(){i["a"].prototype.$bus=this,i["a"].prototype.$wx=z.a,i["a"].prototype.$dayjs=U.a,i["a"].prototype.$api="http://amap.100pq.cn/laravel/api/"},mounted:function(){},render:function(t){return t(m)},router:q}).$mount("#app")},"6d04":function(t,e,a){t.exports=a.p+"img/countdown.a1427068.png"},af1a:function(t,e,a){t.exports=a.p+"img/useCoupons.6e44d759.jpg"},b041:function(t,e,a){},fc23:function(t,e,a){"use strict";a("b041")}});
//# sourceMappingURL=app.bb518963.js.map