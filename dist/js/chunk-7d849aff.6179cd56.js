(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d849aff"],{"0cb2":function(t,i,a){var e=a("e330"),n=a("7b0b"),o=Math.floor,c=e("".charAt),s=e("".replace),r=e("".slice),u=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,d=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,i,a,e,v,l){var p=a+t.length,f=e.length,h=d;return void 0!==v&&(v=n(v),h=u),s(l,h,(function(n,s){var u;switch(c(s,0)){case"$":return"$";case"&":return t;case"`":return r(i,0,a);case"'":return r(i,p);case"<":u=v[r(s,1,-1)];break;default:var d=+s;if(0===d)return n;if(d>f){var l=o(d/10);return 0===l?n:l<=f?void 0===e[l-1]?c(s,1):e[l-1]+c(s,1):n}u=e[d-1]}return void 0===u?"":u}))}},"2d18":function(t,i,a){"use strict";a("f00b")},5319:function(t,i,a){"use strict";var e=a("2ba4"),n=a("c65b"),o=a("e330"),c=a("d784"),s=a("d039"),r=a("825a"),u=a("1626"),d=a("5926"),v=a("50c4"),l=a("577e"),p=a("1d80"),f=a("8aa5"),h=a("dc4a"),_=a("0cb2"),y=a("14c3"),b=a("b622"),g=b("replace"),m=Math.max,C=Math.min,w=o([].concat),$=o([].push),x=o("".indexOf),k=o("".slice),j=function(t){return void 0===t?t:String(t)},O=function(){return"$0"==="a".replace(/./,"$0")}(),Q=function(){return!!/./[g]&&""===/./[g]("a","$0")}(),M=!s((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}));c("replace",(function(t,i,a){var o=Q?"$":"$0";return[function(t,a){var e=p(this),o=void 0==t?void 0:h(t,g);return o?n(o,t,e,a):n(i,l(e),t,a)},function(t,n){var c=r(this),s=l(t);if("string"==typeof n&&-1===x(n,o)&&-1===x(n,"$<")){var p=a(i,c,s,n);if(p.done)return p.value}var h=u(n);h||(n=l(n));var b=c.global;if(b){var g=c.unicode;c.lastIndex=0}var O=[];while(1){var Q=y(c,s);if(null===Q)break;if($(O,Q),!b)break;var M=l(Q[0]);""===M&&(c.lastIndex=f(s,v(c.lastIndex),g))}for(var P="",Y=0,q=0;q<O.length;q++){Q=O[q];for(var I=l(Q[0]),A=m(C(d(Q.index),s.length),0),B=[],S=1;S<Q.length;S++)$(B,j(Q[S]));var T=Q.groups;if(h){var D=w([I],B,A,s);void 0!==T&&$(D,T);var E=l(e(n,void 0,D))}else E=_(I,s,A,B,T,n);A>=Y&&(P+=k(s,Y,A)+E,Y=A+I.length)}return P+k(s,Y)}]}),!M||!O||Q)},"615f":function(t,i,a){"use strict";a("bd5f")},a29e:function(t,i,a){"use strict";a.r(i);var e=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",[t.user.id&&t.activity.id&&t.activityConfig.activity_id?a("div",{staticClass:"card-container"},[a("van-tabs",{attrs:{type:"card"}},[a("van-tab",{attrs:{title:"可用的",name:"available"}},[t._l(t.availableCoupons,(function(i){return a("div",{key:i.id,on:{click:function(a){return t.dealWithTheCoupon(i)}}},[a("Coupon",{attrs:{value:t.activityConfig.normal_coupon_value,allow_to_use_at:t.activity.allow_to_use_at,expire_at:t.activity.expire_at,description:t.activityConfig.normal_coupon_description,available:"available"==i.state}})],1)})),t._l(t.sharedCoupons,(function(i){return a("div",{key:i.id,on:{click:function(a){return t.dealWithTheCoupon(i)}}},[a("Coupon",{attrs:{value:t.activityConfig.shared_coupon_value,allow_to_use_at:t.activity.allow_to_use_at,expire_at:t.activity.expire_at,description:t.activityConfig.shared_coupon_description,available:"available"==i.state}})],1)}))],2),t._e()],1)],1):t._e(),a("div",[a("van-popup",{model:{value:t.showQrcode,callback:function(i){t.showQrcode=i},expression:"showQrcode"}},[a("van-image",{attrs:{src:t.qrcode}})],1)],1),a("div",[a("van-popup",{model:{value:t.showOfficialAccountQrcode,callback:function(i){t.showOfficialAccountQrcode=i},expression:"showOfficialAccountQrcode"}},[a("van-image",{attrs:{src:"http://cdn4s.100pq.cn/official_account_qrcode.jpg"}})],1)],1),a("div",{staticClass:"footer-nav"},[a("van-button",{attrs:{type:"info",block:""},on:{click:t.back}},[t._v("返回首页 "),a("br"),a("span",{staticClass:"sales_number"},[t._v("已有人"+t._s(t.activity.sales_number)+"参与")])]),a("div",{staticClass:"middle-button"},[a("van-button",{attrs:{type:"danger",size:"large",block:""},on:{click:function(i){t.showOfficialAccountQrcode=!0}}},[a("span",{domProps:{innerHTML:t._s(t.activityConfig.my_coupon_middle_button)}})])],1),a("van-button",{attrs:{type:"info",block:""},on:{click:t.generatePoster}},[a("span",{domProps:{innerHTML:t._s(t.activityConfig.my_coupon_right_button)}})])],1)])},n=[],o=a("5530"),c=(a("4de4"),a("d3b7"),a("ac1f"),a("5319"),a("25f0"),a("99af"),a("d399")),s=a("f43e"),r=a("2f62"),u={name:"Coupons",data:function(){return{qrcode:"",showQrcode:!1,showOfficialAccountQrcode:!1}},components:{Coupon:s["a"]},computed:Object(o["a"])(Object(o["a"])({},Object(r["b"])(["activity","user","config","activityConfig","myPoster"])),{},{availableCoupons:function(){var t=this;return this.user.id&&this.activity.id?this.user.coupons.filter((function(i){return i.activity_id==t.activity.id&&t.$dayjs().isBefore(t.activity.expire_at)&&"normal"==i.type})):[]},sharedCoupons:function(){var t=this;return this.user.id&&this.activity.id?this.user.coupons.filter((function(i){return i.activity_id==t.activity.id&&t.$dayjs().isBefore(t.activity.expire_at)&&"shared"==i.type})):[]},expiredCoupons:function(){var t=this;return this.user.id&&this.activity.id?this.user.coupons.filter((function(i){return i.activity_id==t.activity.id&&!t.$dayjs().isBefore(t.activity.expire_at)})):[]}}),methods:{back:function(){window.history.length>2&&this.$router.back(),this.$router.replace("activity/".concat(this.activity.id))},dealWithTheCoupon:function(t){if("available"==t.state)return this.qrcode=this.$qrcode.getQrBase64(t.id.toString()),void(this.showQrcode=!0);"unactivated"!=t.state?Object(c["a"])({message:"此券已经核销"}):Object(c["a"])({message:"此券还没有激活,邀请好友后激活"})},generatePoster:function(){var t=this;this.myPoster&&this.myPoster.activity_id==this.activity.id?this.$router.push("/poster"):this.user.id&&this.activity.id&&(c["a"].loading({message:"正在为您生成海报",forbidClick:!0,duration:0}),this.axios.post(this.$api+"v3/activity/".concat(this.activity.id,"/participant/").concat(this.user.id,"/poster"),{content:window.location.origin+"/activity/".concat(this.activity.id,"/inviter/").concat(this.user.id),image:this.$qrcode.getQrBase64(window.location.origin+"/activity/".concat(this.activity.id,"/inviter/").concat(this.user.id),{width:150,height:150})}).then((function(i){c["a"].clear(),t.$store.dispatch("setMyPoster",{activity_id:t.activity.id,src:i.data}),t.$router.push("/poster")})))}},created:function(){var t=this;this.$Echo.channel("4s").listen("Used",(function(i){i.user_id==t.user.id&&t.axios.post(t.$api+"v3/init",{activityId:localStorage.activityId,temporaryId:localStorage.temporaryId}).then((function(i){t.showQrcode=!1,t.$store.dispatch("init",i.data)}))}))}},d=u,v=(a("615f"),a("2877")),l=Object(v["a"])(d,e,n,!1,null,"749420ee",null);i["default"]=l.exports},bd5f:function(t,i,a){},f00b:function(t,i,a){},f43e:function(t,i,a){"use strict";var e=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{staticClass:"van-coupon",class:{"van-coupon--disabled":!t.available},staticStyle:{"margin-top":"1rem"}},[a("div",{staticClass:"van-coupon__content"},[a("div",{staticClass:"van-coupon__head"},[a("h2",{staticClass:"van-coupon__amount"},[t._v(t._s(t.value)),a("span",[t._v("元")])]),a("p",{staticClass:"van-coupon__condition"},[t._v("请到门店使用")])]),a("div",{staticClass:"van-coupon__body"},[a("p",{staticClass:"van-coupon__name"},[t._v("优惠券")]),a("p",{staticClass:"van-coupon__valid"},[t._v(" "+t._s(t.$dayjs(t.allow_to_use_at).format("YYYY-MM-DD"))+" 至 "+t._s(t.$dayjs(t.expire_at).format("YYYY-MM-DD"))+" ")])]),a("div",{staticClass:"right_button"},[t.available?[a("van-button",{attrs:{type:"danger"}},[a("span",{staticClass:"text1"},[t._v("点击生成"),a("br"),t._v("二维码")])])]:[a("van-button",{attrs:{disabled:""}},[a("span",{staticClass:"text2"},[t._v("通过海报邀请好友"),a("br"),t._v("激活此券")])])]],2)]),a("p",{staticClass:"van-coupon__description"},[t._v(t._s(t.description))])])},n=[],o={name:"Coupon",props:["value","allow_to_use_at","expire_at","available","description"]},c=o,s=(a("2d18"),a("2877")),r=Object(s["a"])(c,e,n,!1,null,"1df92247",null);i["a"]=r.exports}}]);
//# sourceMappingURL=chunk-7d849aff.6179cd56.js.map