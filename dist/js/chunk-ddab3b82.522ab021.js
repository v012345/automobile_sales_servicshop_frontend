(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ddab3b82"],{"0cb2":function(t,i,a){var e=a("e330"),o=a("7b0b"),n=Math.floor,c=e("".charAt),r=e("".replace),s=e("".slice),u=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,l=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,i,a,e,d,v){var p=a+t.length,_=e.length,f=l;return void 0!==d&&(d=o(d),f=u),r(v,f,(function(o,r){var u;switch(c(r,0)){case"$":return"$";case"&":return t;case"`":return s(i,0,a);case"'":return s(i,p);case"<":u=d[s(r,1,-1)];break;default:var l=+r;if(0===l)return o;if(l>_){var v=n(l/10);return 0===v?o:v<=_?void 0===e[v-1]?c(r,1):e[v-1]+c(r,1):o}u=e[l-1]}return void 0===u?"":u}))}},5319:function(t,i,a){"use strict";var e=a("2ba4"),o=a("c65b"),n=a("e330"),c=a("d784"),r=a("d039"),s=a("825a"),u=a("1626"),l=a("5926"),d=a("50c4"),v=a("577e"),p=a("1d80"),_=a("8aa5"),f=a("dc4a"),h=a("0cb2"),y=a("14c3"),b=a("b622"),g=b("replace"),m=Math.max,C=Math.min,w=n([].concat),$=n([].push),x=n("".indexOf),k=n("".slice),j=function(t){return void 0===t?t:String(t)},O=function(){return"$0"==="a".replace(/./,"$0")}(),Q=function(){return!!/./[g]&&""===/./[g]("a","$0")}(),M=!r((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}));c("replace",(function(t,i,a){var n=Q?"$":"$0";return[function(t,a){var e=p(this),n=void 0==t?void 0:f(t,g);return n?o(n,t,e,a):o(i,v(e),t,a)},function(t,o){var c=s(this),r=v(t);if("string"==typeof o&&-1===x(o,n)&&-1===x(o,"$<")){var p=a(i,c,r,o);if(p.done)return p.value}var f=u(o);f||(o=v(o));var b=c.global;if(b){var g=c.unicode;c.lastIndex=0}var O=[];while(1){var Q=y(c,r);if(null===Q)break;if($(O,Q),!b)break;var M=v(Q[0]);""===M&&(c.lastIndex=_(r,d(c.lastIndex),g))}for(var P="",Y=0,q=0;q<O.length;q++){Q=O[q];for(var I=v(Q[0]),A=m(C(l(Q.index),r.length),0),B=[],S=1;S<Q.length;S++)$(B,j(Q[S]));var T=Q.groups;if(f){var D=w([I],B,A,r);void 0!==T&&$(D,T);var E=v(e(o,void 0,D))}else E=h(I,r,A,B,T,o);A>=Y&&(P+=k(r,Y,A)+E,Y=A+I.length)}return P+k(r,Y)}]}),!M||!O||Q)},"7fdf":function(t,i,a){},a29e:function(t,i,a){"use strict";a.r(i);var e=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",[t.user.id&&t.activity.id&&t.activityConfig.activity_id?a("div",{staticClass:"card-container"},[a("van-tabs",{attrs:{type:"card"}},[a("van-tab",{attrs:{title:"可用的",name:"available"}},[t._l(t.availableCoupons,(function(i){return a("div",{key:i.id,on:{click:function(a){return t.dealWithTheCoupon(i)}}},[a("Coupon",{attrs:{value:t.activityConfig.normal_coupon_value,allow_to_use_at:t.activity.allow_to_use_at,expire_at:t.activity.expire_at,description:t.activityConfig.normal_coupon_description,available:"available"==i.state}})],1)})),t._l(t.sharedCoupons,(function(i){return a("div",{key:i.id,on:{click:function(a){return t.dealWithTheCoupon(i)}}},[a("Coupon",{attrs:{value:t.activityConfig.shared_coupon_value,allow_to_use_at:t.activity.allow_to_use_at,expire_at:t.activity.expire_at,description:t.activityConfig.shared_coupon_description,available:"available"==i.state}})],1)}))],2),a("van-tab",{attrs:{title:"失效的",name:"expired"}},t._l(t.expiredCoupons,(function(i){return a("div",{key:i.id},["normal"==i.type?[a("Coupon",{attrs:{value:t.activityConfig.normal_coupon_value,allow_to_use_at:t.activity.allow_to_use_at,expire_at:t.activity.expire_at,description:t.activityConfig.normal_coupon_description,available:!1}})]:[a("Coupon",{attrs:{value:t.activityConfig.shared_coupon_value,allow_to_use_at:t.activity.allow_to_use_at,expire_at:t.activity.expire_at,description:t.activityConfig.shared_coupon_description,available:!1}})]],2)})),0)],1)],1):t._e(),a("div",[a("van-popup",{model:{value:t.showQrcode,callback:function(i){t.showQrcode=i},expression:"showQrcode"}},[a("van-image",{attrs:{src:t.qrcode}})],1)],1),a("div",[a("van-popup",{model:{value:t.showOfficialAccountQrcode,callback:function(i){t.showOfficialAccountQrcode=i},expression:"showOfficialAccountQrcode"}},[a("van-image",{attrs:{src:"http://cdn4s.100pq.cn/official_account_qrcode.jpg"}})],1)],1),a("div",{staticClass:"footer-nav"},[a("van-button",{attrs:{type:"info",block:""},on:{click:t.back}},[t._v("返回首页 "),a("br"),a("span",{staticClass:"sales_number"},[t._v("已有人"+t._s(t.activity.sales_number)+"参与")])]),a("div",{staticClass:"middle-button"},[a("van-button",{attrs:{type:"danger",size:"large",block:""},on:{click:function(i){t.showOfficialAccountQrcode=!0}}},[a("span",{domProps:{innerHTML:t._s(t.activityConfig.my_coupon_middle_button)}})])],1),a("van-button",{attrs:{type:"info",block:""},on:{click:t.generatePoster}},[a("span",{domProps:{innerHTML:t._s(t.activityConfig.my_coupon_right_button)}})])],1)])},o=[],n=a("5530"),c=(a("4de4"),a("d3b7"),a("ac1f"),a("5319"),a("25f0"),a("99af"),a("d399")),r=a("f43e"),s=a("2f62"),u={name:"Coupons",data:function(){return{qrcode:"",showQrcode:!1,showOfficialAccountQrcode:!1}},components:{Coupon:r["a"]},computed:Object(n["a"])(Object(n["a"])({},Object(s["b"])(["activity","user","config","activityConfig","myPoster"])),{},{availableCoupons:function(){var t=this;return this.user.id&&this.activity.id?this.user.coupons.filter((function(i){return i.activity_id==t.activity.id&&t.$dayjs().isBefore(t.activity.expire_at)&&"normal"==i.type})):[]},sharedCoupons:function(){var t=this;return this.user.id&&this.activity.id?this.user.coupons.filter((function(i){return i.activity_id==t.activity.id&&t.$dayjs().isBefore(t.activity.expire_at)&&"shared"==i.type})):[]},expiredCoupons:function(){var t=this;return this.user.id&&this.activity.id?this.user.coupons.filter((function(i){return i.activity_id==t.activity.id&&!t.$dayjs().isBefore(t.activity.expire_at)})):[]}}),methods:{back:function(){window.history.length>2&&this.$router.back(),this.$router.replace("activity/".concat(this.activity.id))},dealWithTheCoupon:function(t){if("available"==t.state)return this.qrcode=this.$qrcode.getQrBase64(t.id.toString()),void(this.showQrcode=!0);"unactivated"!=t.state?Object(c["a"])({message:"此券已经核销"}):Object(c["a"])({message:"此券还没有激活,邀请好友后激活"})},generatePoster:function(){var t=this;this.myPoster&&this.myPoster.activity_id==this.activity.id?this.$router.push("/poster"):this.user.id&&this.activity.id&&(c["a"].loading({message:"正在为您生成海报",forbidClick:!0,duration:0}),this.axios.post(this.$api+"v3/activity/".concat(this.activity.id,"/participant/").concat(this.user.id,"/poster"),{content:window.location.origin+"/activity/".concat(this.activity.id,"/inviter/").concat(this.user.id),image:this.$qrcode.getQrBase64(window.location.origin+"/activity/".concat(this.activity.id,"/inviter/").concat(this.user.id),{width:150,height:150})}).then((function(i){c["a"].clear(),t.$store.dispatch("setMyPoster",{activity_id:t.activity.id,src:i.data}),t.$router.push("/poster")})))}},created:function(){var t=this;this.$Echo.channel("4s").listen("Used",(function(i){i.user_id==t.user.id&&t.axios.post(t.$api+"v3/init",{activityId:localStorage.activityId,temporaryId:localStorage.temporaryId}).then((function(i){t.showQrcode=!1,t.$store.dispatch("init",i.data)}))}))}},l=u,d=(a("ae46"),a("2877")),v=Object(d["a"])(l,e,o,!1,null,"905b947c",null);i["default"]=v.exports},ae46:function(t,i,a){"use strict";a("7fdf")},f43e:function(t,i,a){"use strict";var e=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{staticClass:"van-coupon",class:{"van-coupon--disabled":!t.available},staticStyle:{"margin-top":"1rem"}},[a("div",{staticClass:"van-coupon__content"},[a("div",{staticClass:"van-coupon__head"},[a("h2",{staticClass:"van-coupon__amount"},[t._v(t._s(t.value)),a("span",[t._v("元")])]),a("p",{staticClass:"van-coupon__condition"},[t._v("无使用门槛")])]),a("div",{staticClass:"van-coupon__body"},[a("p",{staticClass:"van-coupon__name"},[t._v("优惠券")]),a("p",{staticClass:"van-coupon__valid"},[t._v(" "+t._s(t.$dayjs(t.allow_to_use_at).format("YYYY-MM-DD"))+" 至 "+t._s(t.$dayjs(t.expire_at).format("YYYY-MM-DD"))+" ")])])]),a("p",{staticClass:"van-coupon__description"},[t._v(t._s(t.description))])])},o=[],n={name:"Coupon",props:["value","allow_to_use_at","expire_at","available","description"]},c=n,r=a("2877"),s=Object(r["a"])(c,e,o,!1,null,null,null);i["a"]=s.exports}}]);
//# sourceMappingURL=chunk-ddab3b82.522ab021.js.map